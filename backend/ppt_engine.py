from pptx import Presentation
from models import PresentationData
import os
import uuid

def create_pptx_file(data: PresentationData) -> str:
    print(f"ğŸ¨ [Render] æ­£åœ¨æ¸²æŸ“ PPT: {data.topic}...")
    
    # --- æ¸²æŸ“PPTåœ¨è¿™é‡Œå†™æ ¸å¿ƒé€»è¾‘ ---
    # ç›®å‰å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„ PPT
    prs = Presentation("template.pptx") 
    
    # ç®€å•åŠ ä¸€é¡µï¼Œè¯æ˜ä»£ç è·‘é€šäº†
    slide = prs.slides.add_slide(prs.slide_layouts[0])
    slide.shapes.title.text = data.topic
    slide.placeholders[1].text = "Generated by AI Backend"
    
    # ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å
    filename = f"{uuid.uuid4()}.pptx"
    save_path = os.path.join("generated_ppts", filename)
    
    # ç¡®ä¿ç›®å½•å­˜åœ¨
    os.makedirs("generated_ppts", exist_ok=True)
    
    prs.save(save_path)
    print(f"âœ… [Render] æ–‡ä»¶ä¿å­˜è‡³: {save_path}")
    
    return filename